from collections import defaultdict

genome = "ACACGAGATCCAAGCTTGTATCGCATCCGTGATCCGTATCCGTGTATCCAGCGCGAAATATCCGTGTAAAGAGCGCGACGGCGGAGAAATTAATCCCATCCGTGTACGCATATCATCCGTGTAAAGCGCGACGGGTAGCGCGACGTCTATCCGTGTACATCGTCACGTCACAATCCGTGTATACTCGAGTAAAAAGGATCCGTGTAACGTTTGCAGCGCGACGACGGGCAATATCCGTGTATTGTCAGCGCGACGAGTCAGAAAGCGCGACGAGCGCGACGACGGTCAAAGTCGTTCAATTAGATCCGTGTACTCCCATCCGTGTACTGTAGCAGCATCCGTGTAACTGCATCCGTGTACAGCGCGACGATCCGTGTACGGAGCATCCGTGTATGTAACGTACACGATATCCGTGTACGACGGACACCACAACAGCGCATCCGTGTACTTTACGTTAAATCCGTGTAATAAAAGGTATCCGTGTATCCGTGTACGACGAAATGCAGCGCAAATCCGTGTAGAAGAGCGCGACGATGTGATCCGTGTAAATCGGTCAGCGCGACGAGATCCGTGTAGACAGCGCGACGAAGTGGTCGGGATCCGTGTAACGGTAGCAAACATGGTCGGGATATAGGTCGGGATCCCAACTATCGGTTAAGGGTACCTACTCCCCTCCACGCGGTCGGGATCGGGATTGCCAGTGGTTGTATGGAGACGGGAAGTACATCCCCACGGAATTTTGGGTCGGGATCGGTTCGGTTTCCACGATGCCAGCTAGGCATTCGGTCGGTCGGGATCGGGATTACCGGACCGGTCGGGATCGGGATGGCCCGACGTCAGGTCGGGATGAGGTCCTAGGACTGGAAGTTCGAACTGGGTCGGGATTTTCCGTGCCTTGATTACGGTCGGGATGGTCGGGATGTCGGGATGGTCGGGATTAGGTCGGTCGGGATTCGGGATCGGTCGGGATGAGGTCGGGATGTGGTCGGGATCTGCTCACGAAGAGCAATTCGTTCGGGTCGGGGGTCGGGATATTGGTATAGGCGCGCTACCTCGGTCGGGATATTGCGAATCTCCTACCCATAGGCAGCATTCAATGCGGCGGTCGGGATGAGGTCGGGATAAGCGGATTATGGCTTGCCCTGTGTAAGCCGAGGATAGTCTTTTTCTGATATACGGTGGCTCATTGCGTCTATGGGAGCCGTTCACACAGTGCCTCCGGTCCGTGCCGATGCACAACGCCGTAGGCTTCCAGACATCTCCTTACGTTGGGCCACATTTTCATTGCCGTCGTCGCGTGCTGTCTTATGACCCATAGTTGGTGATGAGTATGACCTTACCTGGACCAGCAGCTAAAAGGCGGCAGCACGCTGACACACCACAGCCGTGCTTCAAAGTTCATAGTTCAGAAGCCAGTAGTTCAGACATAGTTCAGAACCGTAGTAGTTCAGAACGAAGTTGTCCGCCCCAAGGGGATGTAGTTCAGACGTAGTTCGCTCTGAACGTTAGTTGCTCTGAACGTTATAGTTTTTAGTTCGCTCTGAACTCAGCTCTGAACATTCAGACGGTCATAGTTCAGCTCTGAACTAGTTGCTCTGAACGGCTCTGAACCGCTCTGAGCTCTGAACATAGTTAGTTCAGAGCTCTGAACAGGTAACTATAAGCTCTGAGCTCTGAACTAGTTCAGACTGAGTGCTCTGAACCAGGGCTCTGAACGGCTCTGAACCGCTCTGAACAGCTGGCTCTGAACGAGCTCTGAACGCTCGACTAGTGCTCTGAACCGCTCTGAACAAACGCTCTGAACGTTAGTTCAGAAGGTTAGTTGCTCTGAACTAGTTGCTCTGAACTGGGCTGGCACTGCTCTGAACCGCTCTGAACCTCTGAACGACTGTGCGCTCTGAACATCGCTCTGAACTTCAGATAGTTCAGACATCGTACCCCCTAACATGTAGTGTTAGTATGTATCTTAGTTCAGACGAGAGATGCTCTGAACCGCTCTGAACGTGAAGGTCTGACGGAGCACAAAGCCGGCTCTGAACAATGGCACAAGCTCTGGCTCTGAACACGTCACGCTCTGAACTAGGCGAGTCTACATTAGGTTGCACATTCCGATAGCAATCCGGACACAGAACACTCGATTAAAATCTGGTTGACAGACCATGTTCGCTTCAATCCTGCCGCTCTGAGAGTTTAGCGGCATGAACCTTATGTTATAAATCAAGGAGTCTCAGCCACAAAATACTATCCCTCACGGATCTGGCATAAGGGTGCTTGATCGATCTGGCAGACTGCAGAGTCCTGAAAACCTGAGATCTGGCACGATCTGGCAAGAAGATCTGGCATCGCTCCCCGGGATCTGGCATCGAATAAGTGCTATAAACTGATCTGGCACCAAAGCCCCCACCCGCCTTAAGGATCTGGCACATTGATGTCCGATCTGGCACGGGATCTGGCAGGTTAAGATCTGGCAGGCAATCTGGCATAGTTAACGTCGAGATCTGGCACTGGGATCTGGCAGACTCACTCTTACCGAATTGTGCATTTACTGGATCTGGCAACTTATTTGGAACATAATAGAAAGATCTGGCAATCGATCTGGCAAATTCGGATCTGGCAGCACCCAGAATGGTGATCTGATCTGGCAACGCTCTGCCTAGCAGTGGGGTCACTAACGTTATCTTCTTGTTTTAGCGCTAGAAGATCTGGCAGATCTGGCATGGTCTGTTTTAGATCTGGCATCGATCTGGCATTAACACAGATCTGGCACGGTTGTCGAATGCCTCCCGGATCTGGCAGCCGATCTGGCAAGAGATCTGGCAGTTTTTTACACGCCTCATGAAGCTTAATGTTTTTTTTTGCCCGGGATTCCGACATAGGCCAACACACCGCGCCTCACGCTAGTCCAGACTCCACAGAGGTCTAACAAAAAGCTCAATGCGCGCCCGGGCTTAGCCGTTGGCTTTACGTTCTGATTGGGACGTATTATGGATTTGCGTACGGAGAGACAAAAACCGACGGTGTGCCCTCAAGATGCCTTATATAAAATCATCTAGGTTAGTTTTGCACGCTCTAAAATAATCACCGTCCCTGTCAATCGTGGGCGGCGAAATAGAGCGTCATCAACCGGATATAAGCTCTCCCCTACGACATCCTCTAACTCTCATATAAGGCGCGCGACATACGCTGCTTACGATATATGCTAGCTAACCAGGATCGTATATTCAAATAGCAGTACTCACTCCAACGCACAGCTTTACTCACCTCGGAGGTGGGCGATTACTTTTTAACCCAACGCGGAGATAACTCCCTTCAAAGGCCGGGCCAGTGCTATCTGGTCGGGTTCCATAAGTTAATCGCGGCCGGGAACGTTAAGCAACACTTCAGTGCCCTAAAGCCAGTCAAACGGGTGACAGGCCAAGACAAAGTAATCGGTTTACTCTGACACAGTTATCACTAGACAGTGAACCGGATAGGGTGTACTTCCGGGCAGAATCGCGCAACGTGGGGATATGGAATAGTGCCCTTATTCGCTCTATGCGCTTCAAGTGTAACAATCAATCGAACACATATCTCGCAGTCCACATATCTCACATATCTCCTTACATATCTCTCTTACACATATCTCGAGGTAACACTAAGCACATATCTCTAGACGTAGTCCGGCAGCACATATCACATATCTCCTCGACATATCTCGAACATATCTCAGACATATCTCCGTGGCCGCGGAACAGCACATATCTCATCTCACGGCACATATCTCCTCTGGTGGACCAACCCATGTGATAGCGCTAGCCACACATATCTCAGACCTATTTCTTGACATATCTCCCTTTGTTAGCAACCATACATATCTCCGTAAATACATATCTCATATCTCCTACATATCTCATCTCTACATCTGATCACATATCTCACGTCACATATCTCCCACTAGCAAGTTTCGGAGGAGACATATCTCTGCGCGCGCGCCAAGAGGGTCTCACATTATGCTACATCACATATCTCTACATCTGCATCTGCGACTGTAACACATATCTCTGATCTAACATATCTCCTACATCACACATATCTCCTCCTCTCACTACATCTGTACATATCTCACATCACATATCTCTGCTACATCTGGGTTGGTACATATCTCGTTAACCTCTACATCTGTACATCTGTTTGGCTATTCGCTCTACATCTGGCTACTACATCTGCGAGGGCCCTGGTTTTTTAGGCACGCCTTTTGTAGAATGGGGCACGCCTACATCTGATCTGTCCTGCACGCCTAAGGCACGCCTCGCCTCGGCCCTACATCTGACATCTGCGCAGGGGGCACGCCTCTACGCCTCGTCCTTGGCACGCGGCACGCTACATCTGATCTGTCCGATATGTACGGGCACGCCTATAAAGCTACACCCACATTCTACACTACATCTGTACGCTACATCTGGCAAGGCCGGTTGCCGGCTACATCTGCATAAACTGGGGCACGCCTTCTGCTGGTGCAATAGGGGCACGCCTGGTCGCGGCACGCCTCCTGAAGGGTAACCCGGGTTACAGGTCCGTATCATGGCGGCAGGCACGCCTTCGGGCATTGGCACGCCTGATCCCAGGGCCGCCCGGCCTGGCACTAAAGCGGGTAGTCTCGGAGTTAAACAGGGCGGCACATTGTCTTGCTATTGTCTTGTGAGAATATTGTCTTGGATTGTCTTGTACCAGATTGTCTTGCACGGCACGCCTCAACGGCACGCCTTATTGTCTTGCCCATTCGGATAATTGTCTTGCCTCCTTCTCTCTTGGGAATTGTCTTGTTAAGCCGCGTAAGACCATTGTCTTGGAATCAATTGTCTTGGCGGGACGCGACAGTGAATTTTTTCCCCCGCCCGTATGGATATTGTATTGTCTTGTGTAACACGGCATTGTCTTGTCTTGTATTGTCTTGACATTGTATTGTCTTGTTGCAGAATTGTCTTGTTGCAGATTGTCTTGGTTGGTAGTATCAAATTGTCTTGTGTCGGGTTATATTGTCTTGGCTCATTGATTGTCTTATTGTCTTGTTGTCTTGAACCAGTGGGCCATTGTCTTGCTGGGTATTGTCTTGGGCAGTGCTATATTGTCTTGTGATGAGCGCATTGTCATTGTCTTGGAGTGGCAATAATGCGGTGCATTGTCTTGCGGTGGAGAGCGCAATTGATTGTCTTGGACGAGCGCACGCGGAGAGATTGTCTTGAGAGCGCACGGCCGGAGCGCACGGCGAGCGCACGCGAGCGCACGAGGGTTGGAGACTAGAGCGCACGTAGACGACTGGAGCGCACGGTCAGAGCGCACGCACGGAGAGCGCACGGGAGCGCACGTATCTAGGAGCGCACGGCGAGCGCACGCCGGGAATGACTCTGTGGCGAGCGCACGAACCATGCTATCCAAGTGGCCCGAGCGCACGTCATTTCCAGCGGAATGAGCGCACGGCGCACGCCCCTCGACAGTCTCTGGGAGCGCACGGCTGTGGAGCGCACGCCCCCGACCTGGAGCGCACGACGTATTCTACAACGGAGCGGAGCGCACGTGAGCGCACGGCGGAGGGACGCTGCGGCGGAGCGCACGGAGCGCACGAGAGCGCACGGCGCGAGCGCACGTACAGTCCTTGGACGAGGGCGTTGATAAGTTGTTAAACTGTGTGAGCACCCATTGTGTGAGTTATTTAATTTCGAGTAGAGCGCACGGGGTAGCACTGATATACGCAGTGGCTCCGGACTTGCCTGCGATAGATAGCTGCCTGTTCCAGTGGCGTTTCCAGCCCAAACAGAAATAGTCCGTCCCGATGACTACCCTACTCTGCTAGTCTTGGTAGAGTAACTGTTGCGGAAAAGACATCGGTAGGGACGAATACAACCGGCTCGGTTCGTCGGTATCGGTAGGGGGCTTTCGGTAGGGCTCGTCGGTAGGGGGTAGGGGGTCGGTAGGGTTGACGTCGTAGGAATCGGTAGGGCGCATTGATGGTAGTGTCGGTAGGGGGTAGGGGCCAGGTGTCGGTAGGGTACCCATGTCCGTCGGTATCGGTAGGGAACGAGGGGTTTCGTACTAGTCGGTAGGGAGTGGGTGCCTCGGTAGGGAGGCTGGTCGGTAGTCGGTAGGGGTAGGGATCCGGCTCCCGAAGGACTACGGTATCGGCGCCGCCCCCCATAGTCGGTAGGGGTCGGTAGGGTTCGGTAGGGTGTAGGATCACTTCGTCGGTAGGGGACCCACGTCTCGGTAGGGCGGTTCCCCAGGGACTTGTGTACCCACACCCTTCCCGTCGGGCTCTGGGAGAAGATCTATCAGTATATTTTAGATACACCTGTCGGTAGGGGCTGATTCGTCGGTAGGGTGAATCGGTAGGGTGCATTTCTCGGTAGGGCATCTGGGAACGACCGTCGGTAGGGGCTGCGATTGAGGTATCCCTGATATAATCGGTCGGTAGGGAAGCCCGGCCTCCGCTTACCCTTTTAGGCGTTACATCCAATACAGTCCTCTTAAAATTTTCTCATCAGAATTGCCCTCACTTCAGGCAGGGTAAGCTCATTTCATAATCCACCAGTCTCAGGAGATAGCGGCACGACTACAAGTTGTCTGTGTTTTCCGCGAACTCATAGGTTGACGGAGAGCCGTCCATGACCAGTAATCGACAACTACATGGCGCCTGTAAGCTACGCAATATTATGGCAACACTCCGTTTTTCCTTAGGCGGGGTATTAACCTCATGCCCCCCATACAAACCTATCTCAAGCCTGGGACCGCGCTAGAGTTATTAGCGAAGATTACGGCCACAATTTAGACAGCCTATACGCACTAGGATCGTTTACAACTTGTTACCTTTGAAGGGCAGCAAGTAGGGGTCAGACGAGCAAACATCTCGGCGCTTTCATATGTTGCCTTGTCTGCCCTCGATTCACTCCGACATCCTCGACCCTAGCTAATCACACAAACCTCAGCTTACGGTGTACAGCAGAACGCTTCACGCCTAAAATGAGGCAGGATAGTGTCCCTTAGAACTGATTATAACTAGTTTCATTAGTTGTCATGGCAGTTGCTGTAAGATATACAATCATATCGCAGATGTCATCCCCAGAACAATGGCATATTCGAATATGGCCGTAACATGCGACCTCTACGGATCCGCTCCAACGTGTCATATGGGCGAAGGTAGAAGGATCCAATACAGTACACGAATACGTACGCTTAATTCTGCTCGTGGTTTTACGATCCCGCGGTTATCCAAAAGGATAAATTCGGCCTACTGACAACCTCCGAGGTTGTCTTACGTGCATCTTCATGGGGATGGCTAGCGATTTGTCTTGTGCTCAACTACTTCGTGACAATGGACACAAAAACTATCCTTGCTTAAGGGTGTGTTGGGCAGAACTACACAGTCGCTGCCCCAATCACTTTAGACAGTTCGTCCCCCCGACAACGGAAAGCATATGTTGCGGAGAAGGACCTGTCGAGCTTAAGTATATGCCAAGCCTCCACCGAACTCTGGGCCCGTTCGGGGATATTAATCAGGCATTGGAGTGCGGCGGGCAAATCAGAGGACGTACCATTATGCGGTGGTGGGTCCCGCTGGACCTCGTTCAGATGTAGTCTGGGTAATTATTCTCCTCCTCAATAAGGTAAGCCCGTAAAGCTAGTGCATAACTGTAATCACCCACTGTTACTTTAGTACAAAGAATATGCAACAACTGCTAGCAGTTGATGCTATGAAACAGCCGACACGCCGAGTCGATTAAATCCAGCCGTGTCCCGCGAAACGGGTGCGGCCAAAGTTTGGTGCTTCAGTCTCCGAATCCGCCGCGGGTTTACTATTCGCTTATATGTCTGTGGATTGCTCGGCGGGCCTATATCCCGTGAACGATAGGACAACCGTTGCCATAACCGCGGGAAGTGCCCAGCTTGGTTGTAGCACCCGAGTCGCTTTATCGGAAGTCGGCATGCATATTCAGAGTTAAGATACTGCATACTTCCGTCGGGGATGGGGATGACTATGCGTGAGTCGTTTTCCGTCGGTATGGACCGATTCCGTCGGTCTGGTGTTATTCCGTCGGTTCCGTCGGCTTGAGATCCCTCTTCCGTCGGAGCCTAATGTTCAGTGCCAAAATTTCCGTCGGGGCACTTTGCATCATAAGCTATTCCGTCGGGTCCGTCGGCTCGAGTCCGGGCGTTCCGTCGGGTTACGGGGGATGCAACGAACGATTCCTTCCGTCGGTCATTCCGTCGGCTAGGCTTTTCCTTCCTTCCGTCGGCGGCTTCCGTCGGTTCCGTCGGCTTCCGTCGGATCAGTGGAAGTTCCGTCGTTCCGTCGGCTATTCCGTCGGGGGCCTTCCGTCGGCAACGTTCCGTCGGGTTCCTTCCGTCGGCGTCGGTTGTGCCTGACTCATTACTTCCGTCGGGTAATCTTCCGTCGGGTAAACTTGTTTCCGTCGGTAATAGGAGTTTTCCGTCGGCGTCGGCATGTCCCAGGCTACTTGTAATGTGTACCCGACTACTTGTAACTTACTTGTAATTCGCGTGACGGCGCTAGAACTTAGTTCACACTTGTAATTTACGAACTTGTAATTAGACACCGCTACCTGGGACTTGTAATTTGTAATGAATGCCCTTCATCACTTGTAATAGAGCTAACTTGCTACTTGTAAACTTGTAATAGTAACCGGCGTACTTGTAATAGGCACTTGTAATCGAAAACGTCACTGGCTGAGGAAACTTTGCGGAGTGAAATACTTGTAATATTAATTAACCACCATCCCAATTACCTCTTCAACGTGGGAGAACGATCTTTGTTGCAGAGTATTCGTACTTGTAATCTTGGTTGCAGAGGTCTTACTTGAGTTGCAGAGCTTGTAATGTAATCAGTTGCAGGTTGCAGAGTTGCAGAGGTTGCAGAGTCGGGTACTTGTAATTGTATACTGTTGCAGAGGGTCAAATCAGGTTGCAGAGTTTACTTGTAATTGGTTGCAGAGTGGTTGCAGAGGTTGCAGAGAGCGGGAGTTGCAGAGGCAGAGTTGCAGAGACATCGCTCGTTGCAGAGGTTATTGAAAGTCAAAGGTTGCAGAGTCGTTGCAGAGGGTCACACGACTCTTCGGTTGCAGAGGCAGAGCTTTTTGACAGCTAGCTTAGAAGATGTTGCAGAGATGTTGCAGAGCCCCAGCAGGGCGTTGCAGAGCTTCGGTTGCAGTTGCAGAGAGGAGGCCGTTCACTTCAATCGGTCTTCAGGGTTGGGCACCAGCCAGCCAACTGTTGGTTGCAGAGGTTGTTGCAGAGCAGCCAACTCCTGTTGCAGGTTGCAGAGCCAACTCACTCATGTTGCAGAGAGTCTCTATACCTGTTGCAGAGTTGCAGACGGCGGCTACGGCTAACTCTTCTACCTTAGCCAACTCGGCGCGGCGGCTAATACCTTCTATCGGCGGCTACTCTTAGCCAACTCCTATACGGCGGCGGCGGCTAAACGGCGGCTACTCTTCTAACCAGCCAACTAGCCAACTCCCTTCTATACCGGCGGCTACCGGCGGCTATTCTATACCTAGCCAACTCGGCGGCTAAGCCAACTCAACTCAGCCAAGCCAACTCACTCAGCCAACTCACGGCGGCTACGGCGGCTATCAGCCAACCGCGGCGGCTACGGCTAGCTAGCCAACCGGCGGCTATCAGCCAACTCAGCCAACTCCGGCGGCCGGCGGCTACGGCGGCTATACGGCGGCTCGGCGGCTAACGGCGGCCGGCGGCTATACGGCGGCTACGGCGGCTACGGCGGCTACGGCGGCTACGGCGGCTACGGCGGCTACGGCGGCTA"

kmer = 9 
windowsize = 539
min_clumpsize = 20


def get_substrings(g, k):
 
    substrings = list()

    for i in range(k):
        line = g[i:]
        substrings += [line[i:i + k]
                       for i in range(0, len(line), k) if i + k <= len(line)]

    results = defaultdict(int)
    for s in substrings:
        results[s] += 1
    return results


def find_clumps(genome, kmer, windowsize, clumpsize):

    window = genome[0:windowsize]

    patterns = get_substrings(window, kmer)

    relevant = {p: 1 for p in patterns if patterns[p] >= clumpsize}

    starting_string = genome[0:kmer]

    for i in range(windowsize, len(genome)):
        window = window[1:]
        window += genome[i]
        patterns[starting_string] -= 1
        starting_string = window[0:kmer]
        ending_string = window[-kmer:]
        patterns[ending_string] += 1
        if patterns[ending_string] >= clumpsize and ending_string not in relevant:
            relevant[ending_string] = 1
    return list(relevant)


clumps = find_clumps(genome, kmer, windowsize, min_clumpsize)
print(" ".join(str(x) for x in clumps))
